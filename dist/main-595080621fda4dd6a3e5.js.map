{"version":3,"sources":["webpack:///./assets/bean.js","webpack:///./assets/common.js","webpack:///./assets/components/button.js","webpack:///./assets/components/link-button.js","webpack:///./assets/components/popup/buttons.js","webpack:///./assets/components/popup/header.js","webpack:///./assets/components/popup/manager.js","webpack:///./assets/components/popup/overlay.js","webpack:///./assets/components/popup/popup.js","webpack:///./assets/components/popup/viewport.js","webpack:///./assets/components/popup/wrapper.js","webpack:///./assets/front-end-vars.js","webpack:///./assets/index.css","webpack:///./assets/index.js","webpack:///./assets/qwery.js"],"names":["bean","setSelectorEngine","waitForImages","el","images","document","querySelectorAll","Promise","all","_","compact","map","img","complete","resolve","reject","addEventListener","callbacks","textarea","mousedownEventHandler","e","target","tagName","mouseupEventHandler","forEach","callback","onTextareaResize","length","on","window","push","offTextareaResize","filter","c","off","Button","type","$","data","$el","disabled","hasClass","attr","fire","key","_shouldFirePress","preventDefault","dispatchEvent","CustomEvent","bubbles","detail","includes","removeAttr","_disabled","LinkButton","Buttons","options","_options","createElement","html","template","replaceWith","$mainButton","$auxiliaryButton","mainButton","auxiliaryButton","button","$button","Header","$closeButton","Manager","mode","queryString","parse","location","search","_mode","_viewport","popup","hideScrollbars","_popup","pageXOffset","bind","pageYOffset","scrollbarState","afterShow","_keydownEventHandler","_resizeEventHandler","popupManager","onUpdateExtents","event","beforeDestroy","afterDestroy","showScrollbars","enterHasBeenHandled","onEnter","destroy","_enterHasBeenHandled","updateExtents","clientHeight","documentElement","shown","getBoundingClientRect","Overlay","body","appendChild","remove","Popup","adopt","_overlay","onClick","concat","Array","join","css","Object","assign","title","onCloseClick","_buttons","_popupWrapper","scrollbars","common","then","_textareaResizeEventHandler","has","popupClicked","_shown","hadPositionAbsolute","minClientHeight","parseInt","frontEndVars","offsetHeight","minClientWidth","offsetWidth","willHavePositionAbsolute","clientWidth","top","Math","round","left","method","press","r","Viewport","$siteInnerContainer","childNodes","$siteOuterContainer","append","scroll","_vertScrollbarWidth","innerWidth","_horzScrollbarHeight","innerHeight","_siteWidth","_siteHeight","_pageXOffset","_pageYOffset","style","width","height","vert","horz","Wrapper","$popup","$popupWrapper2","row","insertRow","$popupWrapper3","insertCell","_popupClicked","paddingTop","$basketPopupLink","$textareaPopupLink","$modeLink","$allButFooter","$contentTextarea","$footer","BasketPopup","class","content","buttons","role","label","onPress","$popupContent","focus","each","deleteButton","parent","TextareaPopup","initTextarea","otherMode","text","pathname","stringify","removeClass","positionFooter","minHeight","popupShown","viewportClientHeight","updateSiteMinWidth","minWidth","max","minSiteWidth","popupBoundingClientRect","parseFloat","$textarea","getComputedStyle","localStorage","setItem","id","JSON","w","getPropertyValue","h","extents","getItem","bonzo","setQueryEngine","selector","opt_root","qwery","aug","T","sel","up","selfOrParent","closest","children","descendants","down","prev","next","siblings","toArray","x"],"mappings":"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","file":"main-595080621fda4dd6a3e5.js","sourcesContent":["import bean from 'bean';\nimport $ from './qwery';\nbean.setSelectorEngine($);\nexport default bean;\n\n\n\n// WEBPACK FOOTER //\n// ./assets/bean.js","import _ from 'lodash';\nimport Promise from 'bluebird';\nimport qs from 'qs';\n\nimport bean from './bean';\n\nexport function waitForImages(el) {\n    const images = document.querySelectorAll('img');\n    return Promise.all(_.compact(_.map(images, img => {\n        if (img.complete) {\n            return;\n        } else\n            return new Promise((resolve, reject) => {\n                img.addEventListener('load', () => {\n                    resolve();\n                });\n            });\n    })));\n}\n\n\nlet callbacks = []\nlet textarea;\n\nfunction mousedownEventHandler(e) {\n    if (e.target.tagName == 'TEXTAREA')\n        textarea = e.target;\n}\n\nfunction mouseupEventHandler(e) {\n    if (textarea) {\n        callbacks.forEach(callback => {\n            callback(textarea)\n        });\n    }\n    textarea = null;\n}\n\nexport function onTextareaResize(callback) {\n    if ( ! callbacks.length) {\n        bean.on(window, 'mousedown', mousedownEventHandler);\n        bean.on(window, 'mouseup', mouseupEventHandler);\n    }\n    callbacks.push(callback);\n}\n\nexport function offTextareaResize(callback) {\n    callbacks = callbacks.filter(c => c != callback);\n    if ( ! callbacks.length) {\n        bean.off(window, 'mousedown', mousedownEventHandler);\n        bean.off(window, 'mouseup', mouseupEventHandler);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/common.js","import $ from '../qwery';\nimport bean from '../bean';\n\nexport default class Button {\n    constructor(el, type = 'button') {\n        if ($(el).data('button'))\n            return $(el).data('button');\n        $(el).data('button', this);\n        this.$el = $(el);\n        this.type = type;\n        this.disabled(this.$el.hasClass('disabled'));\n        if ( ! this.disabled())\n            this.$el.attr('tabindex', 0);\n        bean.on(this.$el[0], 'click', () => bean.fire(this.$el[0], 'press'));\n        bean.on(this.$el[0], 'keydown', e => {\n            switch (e.key) {\n            case ' ':\n            case 'Enter':\n                if (this._shouldFirePress(e.key)) {\n                    if (e.key == ' ')\n                        e.preventDefault();\n                    this.$el[0].dispatchEvent(new CustomEvent('press', {\n                        bubbles: true,\n                        detail: {\n                            key: e.key,\n                        }\n                    }));\n                }\n                break;\n            }\n        });\n    }\n\n    _shouldFirePress(key) {\n        return [' ', 'Enter'].includes(key);\n    }\n\n    disabled(disabled) {\n        if (disabled != null) {\n            this.$el[disabled ? 'addClass' : 'removeClass']('disabled');\n            if (disabled)\n                this.$el.removeAttr('tabindex');\n            else\n                this.$el.attr('tabindex', 0);\n            this._disabled = disabled;\n        }\n        return this._disabled;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/components/button.js","import $ from '../qwery';\nimport Button from './button'\n\nexport default class LinkButton extends Button {\n    _shouldFirePress(key) {\n        return ['Enter'].includes(key);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/components/link-button.js","import _ from 'lodash';\n\nimport $ from '../../qwery';\nimport bean from '../../bean';\nimport Button from '../button';\nimport LinkButton from '../link-button';\n\nexport default class Buttons {\n    constructor(el, options = {}) {\n        this._options = options;\n        this.$el = $(document.createElement('div'));\n        this.$el.attr('class', 'b-popup-buttons');\n        this.$el.html(_.template(\n            '<span role=\"<%- options[\"mainButton\"][\"role\"] %>\"'\n            + ' class=\"main-button b-button\">'\n                + '<span class=\"fleck\"></span>'\n                + '<%- options[\"mainButton\"][\"label\"] %>'\n            + '</span>'\n            + '<% if (options[\"auxiliaryButton\"]) { %>'\n                + '<span role=\"<%- options[\"auxiliaryButton\"][\"role\"] %>\"'\n                + ' class=\"auxiliary-button b-button gray\">'\n                    + '<%- options[\"auxiliaryButton\"][\"label\"] %>'\n                + '</span>'\n            + '<% } %>'\n        )({options: this._options}));\n        $(el).replaceWith(this.$el);\n\n        this.$mainButton = $('.main-button', this.$el);\n        this.$auxiliaryButton = $('.auxiliary-button', this.$el);\n        const mainButton = new Button(this.$mainButton);\n        const auxiliaryButton = this.$auxiliaryButton.length ?\n            new Button(this.$auxiliaryButton)\n        : null;\n\n        bean.on(this.$mainButton[0], 'press', this._options['mainButton']['onPress']);\n        if (this.$auxiliaryButton.length)\n            bean.on(this.$auxiliaryButton[0], 'press',\n                this._options['auxiliaryButton']['onPress']);\n    }\n\n    press(button) {\n        const $button = button == 'main-button' ? this.$mainButton : this.$auxiliaryButton;\n        bean.fire($button[0], 'press');\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/components/popup/buttons.js","import _ from 'lodash';\n\nimport $ from '../../qwery';\nimport bean from '../../bean';\nimport Button from '../button';\n\nexport default class Header {\n    constructor(el, options = {}) {\n        this._options = options;\n        this.$el = $(document.createElement('div'));\n        this.$el.attr('class', 'b-popup-header');\n        this.$el.html(_.template(\n            '<span role=\"button\" class=\"close-button\">&#x00d7;</span>'\n            + '<div class=\"title\">'\n                + '<%- options[\"title\"] %>'\n            + '</div>'\n        )({options: this._options}));\n        $(el).replaceWith(this.$el);\n        const $closeButton = $('.close-button', this.$el);\n        new Button($closeButton);\n\n        bean.on($closeButton[0], 'press', this._options['onCloseClick']);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/components/popup/header.js","import queryString from 'query-string';\n\nimport $ from '../../qwery';\nimport bean from '../../bean';\nimport Viewport from './viewport';\nimport Popup from './popup';\n\nclass Manager {\n    constructor() {\n        const mode = queryString.parse(location.search)['mode'] || 2;\n        this._mode = ['', 'hideViewportScrollbars'][mode - 1];\n        if (this.mode() == 'hideViewportScrollbars')\n            this._viewport = new Viewport;\n    }\n\n    adopt(popup) {\n        if (this.mode() == 'hideViewportScrollbars')\n            this._viewport.hideScrollbars();\n        this._popup = popup;\n        this._popup.options({\n            mode: this.mode(),\n            pageXOffset: this.pageXOffset.bind(this),\n            pageYOffset: this.pageYOffset.bind(this),\n            scrollbarState: this._viewport ?\n                this._viewport.scrollbarState.bind(this._viewport)\n            : null,\n            afterShow: () => {\n                this._keydownEventHandler = this._keydownEventHandler.bind(this);\n                bean.on(window, 'keydown', this._keydownEventHandler);\n                this._resizeEventHandler = this._resizeEventHandler.bind(this);\n                bean.on(window, 'resize', this._resizeEventHandler);\n                bean.fire(popupManager, 'afterShow');\n            },\n            onUpdateExtents: event => {\n                if (event != 'windowResize')\n                    bean.fire(popupManager, 'updateExtents', event);\n            },\n            beforeDestroy: () => {\n                bean.fire(popupManager, 'beforeDestroy');\n                bean.off(window, 'keydown', this._keydownEventHandler);\n                bean.off(window, 'resize', this._resizeEventHandler);\n            },\n            afterDestroy: () => {\n                this._popup = null;\n                if (this.mode() == 'hideViewportScrollbars')\n                    this._viewport.showScrollbars();\n                bean.fire(popupManager, 'afterDestroy');\n            },\n        });\n    }\n\n\n    _keydownEventHandler(e) {\n        if ( ! this._popup)\n            return;\n        switch (e.key) {\n        case 'Enter':\n            if (this.enterHasBeenHandled()) {\n                this.enterHasBeenHandled(false);\n                break;\n            }\n            if (e.target.tagName == 'TEXTAREA')\n                break;\n            if (this._popup.onEnter() == false)\n                break;\n            this._popup.destroy();\n            break;\n\n        case 'Escape':\n            this._popup.destroy();\n            break;\n        }\n    }\n\n    enterHasBeenHandled(enterHasBeenHandled) {\n        if (enterHasBeenHandled != null)\n            this._enterHasBeenHandled = enterHasBeenHandled;\n        return this._enterHasBeenHandled;\n    }\n\n    _resizeEventHandler() {\n        if (this.mode() == 'hideViewportScrollbars')\n            this._viewport.updateExtents();\n        this._popup.updateExtents('windowResize');\n        bean.fire(popupManager, 'updateExtents', 'windowResize');\n    }\n\n\n    pageXOffset() {\n        return this.mode() == 'hideViewportScrollbars'\n            ? this._viewport.pageXOffset()\n            : window.pageXOffset;\n    }\n\n    pageYOffset() {\n        return this.mode() == 'hideViewportScrollbars'\n            ? this._viewport.pageYOffset()\n            : window.pageYOffset;\n    }\n\n    viewportClientHeight() {\n        return this.mode() == 'hideViewportScrollbars'\n            ? this._viewport.clientHeight()\n            : document.documentElement.clientHeight;\n    }\n\n\n    popupShown() {\n        return this._popup && this._popup.shown();\n    }\n\n    popupBoundingClientRect() {\n        return this._popup && this._popup.getBoundingClientRect();\n    }\n\n\n    mode() {\n        return this._mode;\n    }\n}\n\nconst popupManager = new Manager;\nexport default popupManager;\n\n\n\n// WEBPACK FOOTER //\n// ./assets/components/popup/manager.js","import $ from '../../qwery';\nimport bean from '../../bean';\n\nexport default class Overlay {\n    constructor(options = {}) {\n        this._options = options;\n        this.$el = $(document.createElement('div'));\n        this.$el.attr('class', 'b-popup-overlay');\n        document.body.appendChild(this.$el[0]);\n        bean.on(this.$el[0], 'click', this._options['onClick']);\n    }\n\n    destroy() {\n        this.$el.remove();\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/components/popup/overlay.js","import _ from 'lodash';\n\nimport frontEndVars from '../../front-end-vars';\nimport * as common from '../../common';\nimport $ from '../../qwery';\nimport bean from '../../bean';\nimport Overlay from './overlay';\nimport PopupWrapper from './wrapper';\nimport popupManager from './manager';\nimport Header from './header';\nimport Buttons from './buttons';\n\nexport default class Popup {\n    constructor(options = {}) {\n        this._options = {};\n        popupManager.adopt(this);\n        this.options(options);\n        this._overlay = new Overlay({\n            onClick: this.destroy.bind(this),\n        });\n\n        this.$el = $(document.createElement('div'));\n        this.$el.attr('class',\n            ['b-popup'].concat(\n                [this.options('mode') == 'hideViewportScrollbars'\n                    ? 'position-static'\n                    : 'position-fixed'],\n                this.options('class') instanceof Array\n                    ? this.options('class')\n                    : [this.options('class')])\n            .join(' '));\n        this.$el.css('visibility', 'hidden');\n        this.$el.html(_.template(\n            '<div class=\"header-place\"></div>'\n            + '<div class=\"popup-content\">'\n                + this.options('content')\n            + '</div>'\n            + '<div class=\"buttons-place\"></div>'\n        )(Object.assign({\n            options: this.options(),\n        }, this.options('templateVars'))));\n\n        new Header($('.header-place', this.$el), {\n            title: this.options('title'),\n            onCloseClick: this.destroy.bind(this),\n        });\n\n        if (this.options('buttons')) {\n            this._buttons = new Buttons($('.buttons-place', this.$el),\n                this.options('buttons'));\n        }\n\n        this._popupWrapper = new PopupWrapper(this.$el, {\n            mode: this.options('mode'),\n            scrollbars: (this.options('scrollbarState') || (() => {}))(),\n        });\n\n        common.waitForImages(this.$el).then(() => {\n            (this.options('beforeShow') || (() => {}))();\n            this.updateExtents('popupShow');\n            this.$el.css('visibility', 'visible');\n\n            this._textareaResizeEventHandler = textarea => {\n                if (this.$el.has(textarea))\n                    this.updateExtents('popupResize');\n            };\n            common.onTextareaResize(this._textareaResizeEventHandler);\n\n            bean.on(this.$el[0], 'click', e => {\n                this._popupWrapper.popupClicked(true);\n            });\n            this._popupWrapper.options({\n                onClick: this.destroy.bind(this),\n            });\n\n            this._shown = true;\n            this.options('afterShow').forEach(callback => callback());\n        });\n    }\n\n    updateExtents(event) {\n        if (this.options('mode') == 'hideViewportScrollbars') {\n            this._popupWrapper.updateExtents();\n        } else {\n            const hadPositionAbsolute = this.$el.hasClass('position-absolute');\n\n            const minClientHeight = parseInt(frontEndVars['popup-min-margin'])\n                + this.$el[0].offsetHeight\n                + parseInt(frontEndVars['popup-min-margin']);\n\n            const minClientWidth = parseInt(frontEndVars['popup-min-margin'])\n                + this.$el[0].offsetWidth\n                + parseInt(frontEndVars['popup-min-margin']);\n\n            const willHavePositionAbsolute =\n                document.documentElement.clientWidth < minClientWidth\n                || document.documentElement.clientHeight < minClientHeight;\n\n            if ( ! (hadPositionAbsolute && willHavePositionAbsolute)) {\n                let top = Math.round((\n                    document.documentElement.clientHeight - this.$el[0].offsetHeight\n                ) / 3);\n                if (top < parseInt(frontEndVars['popup-min-margin']))\n                    top = parseInt(frontEndVars['popup-min-margin']);\n                if (willHavePositionAbsolute)\n                    top = this.options('pageYOffset')() + top;\n                this.$el.css('top', top + 'px');\n\n                let left = Math.round((\n                    document.documentElement.clientWidth - this.$el[0].offsetWidth\n                ) / 2);\n                if (left < parseInt(frontEndVars['popup-min-margin']))\n                    left = parseInt(frontEndVars['popup-min-margin']);\n                if (willHavePositionAbsolute)\n                    left = this.options('pageXOffset')() + left;\n                this.$el.css('left', left + 'px');\n            }\n            const method = willHavePositionAbsolute ? 'addClass' : 'removeClass';\n            this.$el[method]('position-absolute');\n        }\n        if (this.options('onUpdateExtents'))\n            this.options('onUpdateExtents')(event);\n    }\n\n    onEnter() {\n        this._buttons.press('main-button');\n        return false;\n    }\n\n    destroy() {\n        if (this.options('onDestroy')) {\n            const r = this.options('onDestroy')();\n            if (r == false)\n                return false;\n        }\n        this.options('beforeDestroy') && this.options('beforeDestroy')();\n        common.offTextareaResize(this._textareaResizeEventHandler);\n        this._popupWrapper.destroy();\n        this._overlay.destroy();\n        this._shown = false;\n        this.options('afterDestroy') && this.options('afterDestroy')();\n    }\n\n\n    options(options) {\n        if (options != null && typeof options != 'string') {\n            const afterShow = (this.options('afterShow') || [])\n                .concat(options['afterShow'] || []);\n            Object.assign(this._options, options, {afterShow: afterShow});\n        }\n        return options && typeof options == 'string'\n            ? this._options[options]\n            : this._options;\n    }\n\n    getBoundingClientRect() {\n        return this.$el[0].getBoundingClientRect();\n    }\n\n    shown() {\n        return this._shown;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/components/popup/popup.js","import $ from '../../qwery';\nimport bean from '../../bean';\n\nexport default class Viewport {\n    constructor() {\n        this._shown = true;\n        this.$siteInnerContainer = $(document.createElement('div'));\n        this.$siteInnerContainer.attr('class', 'site-inner-container');\n        while (document.body.childNodes.length) {\n            this.$siteInnerContainer[0].appendChild(document.body.childNodes[0]);\n        }\n        this.$siteOuterContainer = $(document.createElement('div'));\n        this.$siteOuterContainer.attr('class', 'site-outer-container');\n        this.$siteOuterContainer.append(this.$siteInnerContainer);\n        document.body.appendChild(this.$siteOuterContainer[0]);\n    }\n\n    showScrollbars() {\n        this.$siteInnerContainer.css('width', '');\n        this.$siteInnerContainer.css('height', '');\n        this.$siteInnerContainer.css('margin-left', '');\n        this.$siteInnerContainer.css('margin-top', '');\n        this.$siteOuterContainer.css('width', '');\n        this.$siteOuterContainer.css('height', '');\n        $(document.body).css('min-width', '');\n        $(document.body).css('overflow-y', '');\n        window.scroll(this.pageXOffset(), this.pageYOffset());\n        this._shown = true;\n    }\n\n    hideScrollbars() {\n        this._vertScrollbarWidth = window.innerWidth - document.documentElement.clientWidth;\n        this._horzScrollbarHeight = window.innerHeight - document.documentElement.clientHeight;\n        this._siteWidth = document.body.offsetWidth;\n        this._siteHeight = document.body.offsetHeight;\n        this._pageXOffset = window.pageXOffset;\n        this._pageYOffset = window.pageYOffset;\n        $(document.body).css('min-width', 'auto');\n        $(document.body).css('overflow-y', 'auto');\n        this.$siteInnerContainer.css('margin-left', - this._pageXOffset + 'px');\n        this.$siteInnerContainer.css('margin-top', - this._pageYOffset + 'px');\n        this._shown = false;\n        this.updateExtents();\n    }\n\n    updateExtents() {\n        this.$siteOuterContainer.css('width', window.innerWidth - this._vertScrollbarWidth + 'px');\n        this.$siteOuterContainer.css('height', window.innerHeight - this._horzScrollbarHeight + 'px');\n        if (this.$siteInnerContainer[0].style.width\n        && this.$siteOuterContainer[0].offsetWidth > this._siteWidth - this.pageXOffset())\n            this.$siteInnerContainer.css('width', '');\n        else if ( ! this.$siteInnerContainer[0].style.width\n        && this.$siteOuterContainer[0].offsetWidth < this._siteWidth - this.pageXOffset())\n            this.$siteInnerContainer.css('width', this._siteWidth + 'px');\n        if (this.$siteInnerContainer[0].style.height\n        && this.$siteOuterContainer[0].offsetHeight > this._siteHeight - this.pageYOffset())\n            this.$siteInnerContainer.css('height', '');\n        else if ( ! this.$siteInnerContainer[0].style.height\n        && this.$siteOuterContainer[0].offsetHeight < this._siteHeight - this.pageYOffset())\n            this.$siteInnerContainer.css('height', this._siteHeight + 'px');\n    }\n\n\n    scrollbarState() {\n        return this.shown()\n            ? {vert: window.innerHeight > document.documentElement.clientHeight,\n                horz: window.innerWidth > document.documentElement.clientWidth}\n            : {vert: this._vertScrollbarWidth > 0, horz: this._horzScrollbarHeight > 0};\n    }\n\n    pageXOffset() {\n        return this.shown() ? window.pageXOffset : this._pageXOffset;\n    }\n\n    pageYOffset() {\n        return this.shown() ? window.pageYOffset : this._pageYOffset;\n    }\n\n    clientHeight() {\n        return this.shown()\n            ? document.documentElement.clientHeight\n            : this.$siteOuterContainer[0].offsetHeight;\n    }\n\n    shown() {\n        return this._shown;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/components/popup/viewport.js","import frontEndVars from '../../front-end-vars';\nimport $ from '../../qwery';\nimport bean from '../../bean';\n\nexport default class Wrapper {\n    constructor(popup, options = {}) {\n        this.$popup = $(popup);\n        this._options = options;\n        if (this.options('mode') == 'hideViewportScrollbars') {\n            this.$el = $(document.createElement('div'));\n            this.$el.attr('class', 'popup-wrapper');\n            if (this.options('scrollbars')['vert'])\n                this.$el.css('overflow-y', 'scroll');\n            if (this.options('scrollbars')['horz'])\n                this.$el.css('overflow-x', 'scroll');\n\n            const $popupWrapper2 = $(document.createElement('table'));\n            $popupWrapper2.attr('class', 'popup-wrapper-2');\n\n            const row = $popupWrapper2[0].insertRow();\n\n            const $popupWrapper3 = $(row.insertCell());\n            $popupWrapper3.attr('class', 'popup-wrapper-3');\n\n            this.$el.append($popupWrapper2);\n            $popupWrapper3.append(this.$popup);\n            document.body.appendChild(this.$el[0]);\n\n            bean.on(this.$el[0], 'click', () => {\n                if ( ! this.popupClicked())\n                    this.options('onClick')();\n                this.popupClicked(false);\n            });\n        } else {\n            document.body.appendChild(this.$popup[0]);\n        }\n    }\n\n    popupClicked(popupClicked) {\n        if (popupClicked != null)\n            this._popupClicked = popupClicked;\n        return this._popupClicked;\n    }\n\n    updateExtents() {\n        if (this.options('mode') == 'hideViewportScrollbars') {\n            let paddingTop = (this.$el[0].clientHeight - this.$popup[0].offsetHeight) / 3\n                - parseInt(frontEndVars['popup-min-margin']);\n            if (paddingTop < 0)\n                paddingTop = 0;\n            this.$el.css('padding-top', paddingTop + 'px');\n        }\n    }\n\n    destroy() {\n        if (this.options('mode') == 'hideViewportScrollbars')\n            this.$el.remove();\n        else\n            this.$popup.remove();\n    }\n\n    options(options) {\n        if (options != null && typeof options != 'string')\n            Object.assign(this._options, options);\n        return options && typeof options == 'string'\n            ? this._options[options]\n            : this._options;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/components/popup/wrapper.js","export default Object.assign({}, {\n    'popup-min-margin': '20px',\n});\n\n\n\n// WEBPACK FOOTER //\n// ./assets/front-end-vars.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./assets/index.css\n// module id = ./assets/index.css\n// module chunks = 1","import './index.css';\n\nimport queryString from 'query-string';\n\nimport * as common from './common';\nimport $ from './qwery';\nimport bean from './bean';\nimport popupManager from './components/popup/manager';\nimport Popup from './components/popup/popup';\nimport LinkButton from './components/link-button';\n\nconst $basketPopupLink = $('.basket-popup-link');\nconst $textareaPopupLink = $('.textarea-popup-link');\nconst $modeLink = $('.mode-link');\nconst $allButFooter = $('.all-but-footer');\nconst $contentTextarea = $('#content-textarea');\nconst $footer = $('footer');\n\nclass BasketPopup extends Popup {\n    constructor() {\n        super({\n            class: 'b-basket-popup',\n            title: 'Basket',\n            content: '<table class=\"b-basket-popup-content\">'\n                    + '<tr><td><span class=\"delete-button\">&#x00d7;</span>'\n                        + '<td><img src=\"http://via.placeholder.com/50x50\">'\n                        + '<td><a href=\"#\">Item 1</a>'\n                    + '<tr><td><span class=\"delete-button\">&#x00d7;</span>'\n                        + '<td><img src=\"http://via.placeholder.com/50x50\">'\n                        + '<td><a href=\"#\">Item 2</a>'\n                + '</table>',\n            buttons: {\n                mainButton: {\n                    role: 'button',\n                    label: 'Place Order',\n                    onPress: () => this.destroy(),\n                },\n                auxiliaryButton: {\n                    role: 'button',\n                    label: 'Cancel',\n                    onPress: () => this.destroy(),\n                }\n            },\n            afterShow: () => {\n                $('tr a', $popupContent)[0].focus();\n            },\n        });\n        const $popupContent = $('.b-basket-popup-content', this.$el);\n        $('.delete-button', $popupContent).each(deleteButton => {\n            new LinkButton(deleteButton);\n        });\n        bean.on($popupContent[0], 'press', '.delete-button', e => {\n            if (e.detail.key == 'Enter')\n                popupManager.enterHasBeenHandled(true);\n            if ($('tr', $popupContent).length > 1)\n                $(e.target).parent('tr').remove();\n            else\n                this.destroy();\n        });\n    }\n}\nbean.on($basketPopupLink[0], 'click', () => {\n    new BasketPopup();\n});\n\nclass TextareaPopup extends Popup {\n    constructor() {\n        super({\n            class: 'b-textarea-popup',\n            title: 'Message',\n            content: '<textarea id=\"popup-textarea\" class=\"b-textarea-popup-content\">'\n                + '</textarea>',\n            buttons: {\n                mainButton: {\n                    role: 'button',\n                    label: 'Ok',\n                    onPress: () => this.destroy(),\n                },\n            },\n        });\n        const $popupContent = $('.b-textarea-popup-content', this.$el);\n        initTextarea($popupContent);\n    }\n}\nbean.on($textareaPopupLink[0], 'click', () => {\n    new TextareaPopup();\n});\n\nconst otherMode = popupManager.mode() == 'hideViewportScrollbars' ? 1 : 2;\n$modeLink.text('-> mode ' + otherMode);\n$modeLink.attr('href', location.pathname + '?' + queryString.stringify({mode: otherMode}));\n$modeLink.removeClass('invisible');\n\nlet positionFooter;\nif (popupManager.mode() == 'hideViewportScrollbars') {\n    positionFooter = (event) => {\n        // Why add pageYOffset? Consider user scrolling to the bottom of the page,\n        // then opening popup, then enlarging the window vertically.\n        // Footer is supposed to stick to bottom.\n        const minHeight\n            = (popupManager.popupShown() ? popupManager.pageYOffset() : 0)\n            + popupManager.viewportClientHeight() - $footer[0].offsetHeight;\n        $allButFooter.css('min-height', minHeight > 0 ? minHeight + 'px' : '');\n    };\n    bean.on(window, 'resize', () => { positionFooter('resize') });\n    bean.on(popupManager, 'afterDestroy', () => { positionFooter('afterDestroy') });\n\n} else {\n    const minSiteWidth = parseFloat($(document.body).css('min-width'));\n    function updateSiteMinWidth(event) {\n        document.body.style.minWidth = event == 'updateExtents'\n            ? Math.max(\n                minSiteWidth,\n                window.pageXOffset + popupManager.popupBoundingClientRect()['right']\n            ) + 'px'\n            : '';\n    }\n    bean.on(popupManager, 'updateExtents', () => { updateSiteMinWidth('updateExtents') });\n    bean.on(popupManager, 'afterDestroy', () => { updateSiteMinWidth('afterDestroy') });\n\n    positionFooter = (event) => {\n        const minHeight = event == 'updateExtents'\n            ? Math.max(\n                document.documentElement.clientHeight,\n                window.pageYOffset + popupManager.popupBoundingClientRect()['bottom']\n            ) - $footer[0].offsetHeight\n            : document.documentElement.clientHeight - $footer[0].offsetHeight;\n        $allButFooter.css('min-height', minHeight > 0 ? minHeight + 'px' : '');\n    };\n    bean.on(popupManager, 'updateExtents', () => { positionFooter('updateExtents') });\n    bean.on(popupManager, 'afterDestroy', () => { positionFooter('afterDestroy') });\n}\npositionFooter('load');\n$footer.removeClass('invisible');\n\ncommon.onTextareaResize(textarea => {\n    const $textarea = $(textarea);\n    const style = window.getComputedStyle($textarea[0], null);\n    localStorage.setItem('textareaExtents: ' + textarea.id, JSON.stringify({\n        w: style.getPropertyValue('width'),\n        h: style.getPropertyValue('height'),\n    }));\n});\n\nfunction initTextarea(textarea) {\n    const $textarea = $(textarea);\n    let extents = localStorage.getItem('textareaExtents: ' + $textarea[0].id);\n    if (extents) {\n        extents = JSON.parse(extents);\n        $textarea.css({\n            width: extents['w'],\n            height: extents['h'],\n        });\n    }\n}\n\ninitTextarea($contentTextarea);\n$contentTextarea.removeClass('invisible');\n\n\n\n// WEBPACK FOOTER //\n// ./assets/index.js","import qwery from 'qwery';\nimport bonzo from 'bonzo';\nimport T from 'traversty';\n\nbonzo.setQueryEngine(qwery);\n\nexport default function $(selector, opt_root) {\n    return bonzo(qwery(selector, opt_root));\n};\n\nbonzo.aug({\n    has: function(el) {\n        return T(this).has(el).length;\n    },\n\n\n    parent: function(sel = '*') {\n        return $(T(this).up(sel, 0));\n    },\n\n    selfOrParent: function(sel = '*') {\n        return $(T(this).closest(sel, 0));\n    },\n\n    children: function(sel = '*') {\n        return $(T(this).children(sel));\n    },\n\n    descendants: function(sel = '*') {\n        return $(T(this).down(sel));\n    },\n\n\n    prev: function(sel = '*') {\n        return $(T(this).prev(sel, 0));\n    },\n\n    next: function(sel = '*') {\n        return $(T(this).next(sel, 0));\n    },\n\n    siblings: function(sel = '*') {\n        return $(T(this).siblings(sel));\n    },\n\n\n    toArray: function() {\n        return this.map(x => x);\n    },\n});\n\n\n\n// WEBPACK FOOTER //\n// ./assets/qwery.js"],"sourceRoot":""}